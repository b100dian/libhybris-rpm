From aa3dca1d4ca37442c7bcc9313e27bf74971e0250 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Matti=20Lehtim=C3=A4ki?= <matti.lehtimaki@jolla.com>
Date: Thu, 21 Sep 2023 17:26:27 +0300
Subject: [PATCH] Revert "hybris: common: n: Fix loading namespaces for
 non-Android processes"

This reverts commit 5b371216997a0c4067b41ce98cadcfd1cbb8146d.
---
 hybris/common/n/linker.cpp | 16 ----------------
 1 file changed, 16 deletions(-)

diff --git a/hybris/common/n/linker.cpp b/hybris/common/n/linker.cpp
index a874d88c..a0327794 100644
--- a/hybris/common/n/linker.cpp
+++ b/hybris/common/n/linker.cpp
@@ -4446,28 +4446,12 @@ extern "C" int __system_properties_init(void);
 static const char* get_executable_path() {
   static std::string executable_path;
   if (executable_path.empty()) {
-#ifdef DISABLED_FOR_HYBRIS_SUPPORT
     char path[PATH_MAX];
     ssize_t path_len = readlink("/proc/self/exe", path, sizeof(path));
     if (path_len == -1 || path_len >= static_cast<ssize_t>(sizeof(path))) {
       __libc_fatal("readlink('/proc/self/exe') failed: %s", strerror(errno));
     }
     executable_path = std::string(path, path_len);
-#else
-    if (!getauxval(AT_SECURE)) {
-      const char* use_vendor_namespace = getenv("HYBRIS_USE_VENDOR_NAMESPACE");
-      if (use_vendor_namespace != nullptr) {
-        executable_path = "/vendor/bin/yes";
-      }
-    }
-    if (executable_path.empty()) {
-#if defined(__aarch64__) || defined(__x86_64__)
-      executable_path = "/system/bin/app_process64";
-#else
-      executable_path = "/system/bin/app_process32";
-#endif
-    }
-#endif
   }
 
   return executable_path.c_str();
-- 
2.25.1

